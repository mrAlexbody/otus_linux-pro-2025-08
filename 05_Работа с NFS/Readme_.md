–î–æ–º–∞—à–Ω–µ–µ –∑–∞–¥–∞–Ω–∏–µ 05
=
## "–†–∞–±–æ—Ç–∞ —Å NFS"

### –¶–µ–ª—å:
+ –Ω–∞—É—á–∏—Ç—å—Å—è —Å–∞–º–æ—Å—Ç–æ—è—Ç–µ–ª—å–Ω–æ —Ä–∞–∑–≤–æ—Ä–∞—á–∏–≤–∞—Ç—å —Å–µ—Ä–≤–∏—Å NFS –∏ –ø–æ–¥–∫–ª—é—á–∞—Ç—å –∫ –Ω–µ–º—É –∫–ª–∏–µ–Ω—Ç–æ–≤;


### –û–ø–∏—Å–∞–Ω–∏–µ/–ü–æ—à–∞–≥–æ–≤–∞—è –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –¥–æ–º–∞—à–Ω–µ–≥–æ –∑–∞–¥–∞–Ω–∏—è:
### üéØ –ß—Ç–æ –Ω—É–∂–Ω–æ —Å–¥–µ–ª–∞—Ç—å?

+ –∑–∞–ø—É—Å—Ç–∏—Ç—å 2 –≤–∏—Ä—Ç—É–∞–ª—å–Ω—ã—Ö –º–∞—à–∏–Ω—ã (—Å–µ—Ä–≤–µ—Ä NFS –∏ –∫–ª–∏–µ–Ω—Ç–∞);
+ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ NFS –¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å –ø–æ–¥–≥–æ—Ç–æ–≤–ª–µ–Ω–∞ –∏ —ç–∫—Å–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω–∞ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—è;
+ –≤ —ç–∫—Å–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω–Ω–æ–π –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ –¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å –ø–æ–¥–¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—è —Å –∏–º–µ–Ω–µ–º upload —Å –ø—Ä–∞–≤–∞–º–∏ –Ω–∞ –∑–∞–ø–∏—Å—å –≤ –Ω–µ—ë;
+ —ç–∫—Å–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—è –¥–æ–ª–∂–Ω–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –º–æ–Ω—Ç–∏—Ä–æ–≤–∞—Ç—å—Å—è –Ω–∞ –∫–ª–∏–µ–Ω—Ç–µ –ø—Ä–∏ —Å—Ç–∞—Ä—Ç–µ –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–π –º–∞—à–∏–Ω—ã (systemd, autofs –∏–ª–∏ fstab ‚Äî –ª—é–±—ã–º —Å–ø–æ—Å–æ–±–æ–º);
+ –º–æ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ —Ä–∞–±–æ—Ç–∞ NFS –Ω–∞ –∫–ª–∏–µ–Ω—Ç–µ –¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å –æ—Ä–≥–∞–Ω–∏–∑–æ–≤–∞–Ω–∞ —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º NFSv3.

### ‚≠êÔ∏è –ó–∞–¥–∞–Ω–∏–µ —Å–æ –∑–≤–µ–∑–¥–æ—á–∫–æ–π*
+ –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—é —á–µ—Ä–µ–∑ KERBEROS —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º NFSv4
---

### –í–∏—Ä—Ç—É–∞–ª—å–Ω—ã–µ –º–∞—à–∏–Ω—ã:
+ NFS Server (nfs-server) - 172.31.134.60
+ NFS Client (nfs-client) - 172.31.140.41

### –ù–∞—Å—Ç—Ä–æ–π–∫–∞ NFS Server
> –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –ø–∞–∫–µ—Ç–∞:
```shell
root@nfs-server:~# apt install nfs-kernel-server
Reading package lists... Done
Building dependency tree... Done
Reading state information... Done
The following additional packages will be installed:
  keyutils libnfsidmap1 nfs-common rpcbind
Suggested packages:
  watchdog
The following NEW packages will be installed:
  keyutils libnfsidmap1 nfs-common nfs-kernel-server rpcbind
0 upgraded, 5 newly installed, 0 to remove and 0 not upgraded.
Need to get 569 kB of archives.
After this operation, 2,022 kB of additional disk space will be used.
Do you want to continue? [Y/n] y
Get:1 http://ru.archive.ubuntu.com/ubuntu noble-updates/main amd64 libnfsidmap1 amd64 1:2.6.4-3ubuntu5.1 [48.3 kB]
Get:2 http://ru.archive.ubuntu.com/ubuntu noble/main amd64 rpcbind amd64 1.2.6-7ubuntu2 [46.5 kB]
Get:3 http://ru.archive.ubuntu.com/ubuntu noble/main amd64 keyutils amd64 1.6.3-3build1 [56.8 kB]
Get:4 http://ru.archive.ubuntu.com/ubuntu noble-updates/main amd64 nfs-common amd64 1:2.6.4-3ubuntu5.1 [248 kB]
Get:5 http://ru.archive.ubuntu.com/ubuntu noble-updates/main amd64 nfs-kernel-server amd64 1:2.6.4-3ubuntu5.1 [169 kB]
Fetched 569 kB in 0s (3,947 kB/s)
Selecting previously unselected package libnfsidmap1:amd64.
(Reading database ... 87329 files and directories currently installed.)
Preparing to unpack .../libnfsidmap1_1%3a2.6.4-3ubuntu5.1_amd64.deb ...
... –∏ —Ç.–¥.

Creating config file /etc/exports with new version

Creating config file /etc/default/nfs-kernel-server with new version
Processing triggers for man-db (2.12.0-4build2) ...
Processing triggers for libc-bin (2.39-0ubuntu8.6) ...
Scanning processes...
Scanning linux images...

Running kernel seems to be up-to-date.

No services need to be restarted.

No containers need to be restarted.

No user sessions are running outdated binaries.

No VM guests are running outdated hypervisor (qemu) binaries on this host.
```
> –ü—Ä–æ–≤–µ—Ä–∏–ª –ø–æ—Å–ª–µ —É—Å—Ç–∞–Ω–æ–≤–∫–∏
```shell
root@nfs-server:~# netstat -putnl
Active Internet connections (only servers)
Proto Recv-Q Send-Q Local Address           Foreign Address         State       PID/Program name
tcp        0      0 0.0.0.0:48513           0.0.0.0:*               LISTEN      2063/rpc.mountd
tcp        0      0 127.0.0.1:6010          0.0.0.0:*               LISTEN      1251/sshd: amyskin@
tcp        0      0 0.0.0.0:43973           0.0.0.0:*               LISTEN      -
tcp        0      0 127.0.0.53:53           0.0.0.0:*               LISTEN      830/systemd-resolve
tcp        0      0 0.0.0.0:41469           0.0.0.0:*               LISTEN      2053/rpc.statd
tcp        0      0 0.0.0.0:47371           0.0.0.0:*               LISTEN      2063/rpc.mountd
tcp        0      0 0.0.0.0:35003           0.0.0.0:*               LISTEN      2063/rpc.mountd
tcp        0      0 0.0.0.0:22              0.0.0.0:*               LISTEN      1/init
tcp        0      0 0.0.0.0:2049            0.0.0.0:*               LISTEN      -
tcp        0      0 127.0.0.54:53           0.0.0.0:*               LISTEN      830/systemd-resolve
tcp        0      0 0.0.0.0:111             0.0.0.0:*               LISTEN      1/init
tcp6       0      0 :::40953                :::*                    LISTEN      2053/rpc.statd
tcp6       0      0 :::39637                :::*                    LISTEN      -
tcp6       0      0 :::37283                :::*                    LISTEN      2063/rpc.mountd
tcp6       0      0 :::47399                :::*                    LISTEN      2063/rpc.mountd
tcp6       0      0 :::55631                :::*                    LISTEN      2063/rpc.mountd
tcp6       0      0 ::1:6010                :::*                    LISTEN      1251/sshd: amyskin@
tcp6       0      0 :::22                   :::*                    LISTEN      1/init
tcp6       0      0 :::2049                 :::*                    LISTEN      -
tcp6       0      0 :::111                  :::*                    LISTEN      1/init
udp        0      0 127.0.0.1:957           0.0.0.0:*                           2053/rpc.statd
udp        0      0 0.0.0.0:46094           0.0.0.0:*                           -
udp        0      0 0.0.0.0:48476           0.0.0.0:*                           2063/rpc.mountd
udp        0      0 0.0.0.0:50878           0.0.0.0:*                           2063/rpc.mountd
udp        0      0 0.0.0.0:40751           0.0.0.0:*                           2053/rpc.statd
udp        0      0 0.0.0.0:59284           0.0.0.0:*                           2063/rpc.mountd
udp        0      0 127.0.0.54:53           0.0.0.0:*                           830/systemd-resolve
udp        0      0 127.0.0.53:53           0.0.0.0:*                           830/systemd-resolve
udp        0      0 172.31.134.60:68        0.0.0.0:*                           664/systemd-network
udp        0      0 0.0.0.0:111             0.0.0.0:*                           1/init
udp6       0      0 :::43901                :::*                                2063/rpc.mountd
udp6       0      0 :::34026                :::*                                2053/rpc.statd
udp6       0      0 :::50508                :::*                                2063/rpc.mountd
udp6       0      0 :::36843                :::*                                -
udp6       0      0 :::111                  :::*                                1/init
udp6       0      0 :::35423                :::*                                2063/rpc.mountd

root@nfs-server:~# ps aux |grep rpc
_rpc        1553  0.0  0.5   7968  3584 ?        Ss   17:50   0:00 /sbin/rpcbind -f -w
root        1965  0.0  0.0      0     0 ?        I<   17:50   0:00 [kworker/R-rpcio]
root        2052  0.0  0.3   3016  2052 ?        Ss   17:50   0:00 /usr/sbin/rpc.idmapd
statd       2053  0.0  0.2   4560  1668 ?        Ss   17:50   0:00 /usr/sbin/rpc.statd
root        2063  0.0  0.1  43212  1196 ?        Ss   17:50   0:00 /usr/sbin/rpc.mountd
root        2719  0.0  0.3   6544  2304 pts/1    S+   20:51   0:00 grep --color=auto rpc
```
> –°–æ–∑–¥–∞–ª –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é .
```shell
root@nfs-server:~# mkdir -p /srv/share/upload
root@nfs-server:~# ls -la /srv/
total 12
drwxr-xr-x  3 root root 4096 Nov 30 20:55 .
drwxr-xr-x 23 root root 4096 Nov 29 13:26 ..
drwxr-xr-x  3 root root 4096 Nov 30 20:55 share
root@nfs-server:~# ls -la /srv/share/
total 12
drwxr-xr-x 3 root root 4096 Nov 30 20:55 .
drwxr-xr-x 3 root root 4096 Nov 30 20:55 ..
drwxr-xr-x 2 root root 4096 Nov 30 20:55 upload
root@nfs-server:~# chown -R nobody:nogroup /srv/share
root@nfs-server:~# chmod 0777 /srv/share/upload
```
> –ü—Ä–æ–ø–∏—Å–∞–ª —Å—Ç—Ä—É–∫—Ç—É—Ä—É –≤ —Ñ–∞–π–ª–µ /etc/exports
```shell
root@nfs-server:~# cat /etc/exports
# /etc/exports: the access control list for filesystems which may be exported
#               to NFS clients.  See exports(5).
#
# Example for NFSv2 and NFSv3:
# /srv/homes       hostname1(rw,sync,no_subtree_check) hostname2(ro,sync,no_subtree_check)
#
# Example for NFSv4:
# /srv/nfs4        gss/krb5i(rw,sync,fsid=0,crossmnt,no_subtree_check)
# /srv/nfs4/homes  gss/krb5i(rw,sync,no_subtree_check)
#
/srv/share 172.31.140.41/20(rw,sync,root_squash,no_subtree_check)

````
> –î–∞–ª–µ–µ,  –ø–µ—Ä–µ—ç–∫—Å–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞–ª –≤—Å–µ —Ñ–∞–π–ª–æ–≤—ã–µ —Å–∏—Å—Ç–µ–º—ã, —É–∫–∞–∑–∞–Ω–Ω—ã–µ –≤ /etc/exports, –∞ –ø–æ—Ç–æ–º –ø—Ä–æ–≤–µ—Ä–∏–ª
```shell
root@nfs-server:~# exportfs -r
root@nfs-server:~# exportfs -s
/srv/share  172.31.140.41/20(sync,wdelay,hide,no_subtree_check,sec=sys,rw,secure,root_squash,no_all_squash)
````
>> –ï—Å–ª–∏ –Ω–µ —É–∫–∞–∑–∞—Ç—å –æ–ø—Ü–∏—é subtree_check –∏–ª–∏ no_subtree_check –≤ —Ñ–∞–π–ª–µ /etc/exports, —Ç–æ –±—É–¥–µ—Ç –æ—à–∏–±–∫–∞!
```shell
root@nfs-server:~# exportfs -r
exportfs: /etc/exports [1]: Neither 'subtree_check' or 'no_subtree_check' specified for export "172.31.140.41/20:/srv/share".
  Assuming default behaviour ('no_subtree_check').
  NOTE: this default has changed since nfs-utils version 1.0.x
```

### –ù–∞—Å—Ç—Ä–æ–π–∫–∞ NFS Client
> –£—Å—Ç–∞–Ω–æ–≤–∏–ª –ø–∞–∫–µ—Ç –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å nfs
```shell
root@nfs-client:~# sudo apt install -y nfs-common
–ß—Ç–µ–Ω–∏–µ —Å–ø–∏—Å–∫–æ–≤ –ø–∞–∫–µ—Ç–æ–≤‚Ä¶ –ì–æ—Ç–æ–≤–æ
–ü–æ—Å—Ç—Ä–æ–µ–Ω–∏–µ –¥–µ—Ä–µ–≤–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π‚Ä¶ –ì–æ—Ç–æ–≤–æ
–ß—Ç–µ–Ω–∏–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ —Å–æ—Å—Ç–æ—è–Ω–∏–∏‚Ä¶ –ì–æ—Ç–æ–≤–æ
–°–ª–µ–¥—É—é—â–∏–µ –ø–∞–∫–µ—Ç—ã —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–ª–∏—Å—å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∏ –±–æ–ª—å—à–µ –Ω–µ —Ç—Ä–µ–±—É—é—Ç—Å—è:
  libflashrom1 libftdi1-2
–î–ª—è –∏—Ö —É–¥–∞–ª–µ–Ω–∏—è –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ ¬´sudo apt autoremove¬ª.
–ë—É–¥—É—Ç —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã —Å–ª–µ–¥—É—é—â–∏–µ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –ø–∞–∫–µ—Ç—ã:
  keyutils libnfsidmap1 rpcbind
–ü—Ä–µ–¥–ª–∞–≥–∞–µ–º—ã–µ –ø–∞–∫–µ—Ç—ã:
  watchdog
–°–ª–µ–¥—É—é—â–∏–µ –ù–û–í–´–ï –ø–∞–∫–µ—Ç—ã –±—É–¥—É—Ç —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã:
  keyutils libnfsidmap1 nfs-common rpcbind
–û–±–Ω–æ–≤–ª–µ–Ω–æ 0 –ø–∞–∫–µ—Ç–æ–≤, —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ 4 –Ω–æ–≤—ã—Ö –ø–∞–∫–µ—Ç–æ–≤, –¥–ª—è —É–¥–∞–ª–µ–Ω–∏—è –æ—Ç–º–µ—á–µ–Ω–æ 0 –ø–∞–∫–µ—Ç–æ–≤, –∏ 8 –ø–∞–∫–µ—Ç–æ–≤ –Ω–µ –æ–±–Ω–æ–≤–ª–µ–Ω–æ.
–ù–µ–æ–±—Ö–æ–¥–∏–º–æ —Å–∫–∞—á–∞—Ç—å 381 kB –∞—Ä—Ö–∏–≤–æ–≤.
–ü–æ—Å–ª–µ –¥–∞–Ω–Ω–æ–π –æ–ø–µ—Ä–∞—Ü–∏–∏ –æ–±—ä—ë–º –∑–∞–Ω—è—Ç–æ–≥–æ –¥–∏—Å–∫–æ–≤–æ–≥–æ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–∞ –≤–æ–∑—Ä–∞—Å—Ç—ë—Ç –Ω–∞ 1‚ÄØ447 kB.
–ü–æ–ª:1 http://ru.archive.ubuntu.com/ubuntu jammy-updates/main amd64 libnfsidmap1 amd64 1:2.6.1-1ubuntu1.2 [42,9 kB]
–ü–æ–ª:2 http://ru.archive.ubuntu.com/ubuntu jammy/main amd64 rpcbind amd64 1.2.6-2build1 [46,6 kB]
–ü–æ–ª:3 http://ru.archive.ubuntu.com/ubuntu jammy/main amd64 keyutils amd64 1.6.1-2ubuntu3 [50,4 kB]
–ü–æ–ª:4 http://ru.archive.ubuntu.com/ubuntu jammy-updates/main amd64 nfs-common amd64 1:2.6.1-1ubuntu1.2 [241 kB]
–ü–æ–ª—É—á–µ–Ω–æ 381 kB –∑–∞ 0—Å (3‚ÄØ989 kB/s)
–í—ã–±–æ—Ä —Ä–∞–Ω–µ–µ –Ω–µ –≤—ã–±—Ä–∞–Ω–Ω–æ–≥–æ –ø–∞–∫–µ—Ç–∞ libnfsidmap1:amd64.
(–ß—Ç–µ–Ω–∏–µ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö ‚Ä¶ –Ω–∞ –¥–∞–Ω–Ω—ã–π –º–æ–º–µ–Ω—Ç —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ 75572 —Ñ–∞–π–ª–∞ –∏ –∫–∞—Ç–∞–ª–æ–≥–∞.)
–ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –∫ —Ä–∞—Å–ø–∞–∫–æ–≤–∫–µ ‚Ä¶/libnfsidmap1_1%3a2.6.1-1ubuntu1.2_amd64.deb ‚Ä¶
–†–∞—Å–ø–∞–∫–æ–≤—ã–≤–∞–µ—Ç—Å—è libnfsidmap1:amd64 (1:2.6.1-1ubuntu1.2) ‚Ä¶
–í—ã–±–æ—Ä —Ä–∞–Ω–µ–µ –Ω–µ –≤—ã–±—Ä–∞–Ω–Ω–æ–≥–æ –ø–∞–∫–µ—Ç–∞ rpcbind.
–ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –∫ —Ä–∞—Å–ø–∞–∫–æ–≤–∫–µ ‚Ä¶/rpcbind_1.2.6-2build1_amd64.deb ‚Ä¶
–†–∞—Å–ø–∞–∫–æ–≤—ã–≤–∞–µ—Ç—Å—è rpcbind (1.2.6-2build1) ‚Ä¶
–í—ã–±–æ—Ä —Ä–∞–Ω–µ–µ –Ω–µ –≤—ã–±—Ä–∞–Ω–Ω–æ–≥–æ –ø–∞–∫–µ—Ç–∞ keyutils.
–ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –∫ —Ä–∞—Å–ø–∞–∫–æ–≤–∫–µ ‚Ä¶/keyutils_1.6.1-2ubuntu3_amd64.deb ‚Ä¶
–†–∞—Å–ø–∞–∫–æ–≤—ã–≤–∞–µ—Ç—Å—è keyutils (1.6.1-2ubuntu3) ‚Ä¶
–í—ã–±–æ—Ä —Ä–∞–Ω–µ–µ –Ω–µ –≤—ã–±—Ä–∞–Ω–Ω–æ–≥–æ –ø–∞–∫–µ—Ç–∞ nfs-common.
–ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –∫ —Ä–∞—Å–ø–∞–∫–æ–≤–∫–µ ‚Ä¶/nfs-common_1%3a2.6.1-1ubuntu1.2_amd64.deb ‚Ä¶
–†–∞—Å–ø–∞–∫–æ–≤—ã–≤–∞–µ—Ç—Å—è nfs-common (1:2.6.1-1ubuntu1.2) ‚Ä¶
–ù–∞—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç—Å—è –ø–∞–∫–µ—Ç libnfsidmap1:amd64 (1:2.6.1-1ubuntu1.2) ‚Ä¶
–ù–∞—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç—Å—è –ø–∞–∫–µ—Ç rpcbind (1.2.6-2build1) ‚Ä¶
Created symlink /etc/systemd/system/multi-user.target.wants/rpcbind.service ‚Üí /lib/systemd/system/rpcbind.service.
Created symlink /etc/systemd/system/sockets.target.wants/rpcbind.socket ‚Üí /lib/systemd/system/rpcbind.socket.
–ù–∞—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç—Å—è –ø–∞–∫–µ—Ç keyutils (1.6.1-2ubuntu3) ‚Ä¶
–ù–∞—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç—Å—è –ø–∞–∫–µ—Ç nfs-common (1:2.6.1-1ubuntu1.2) ‚Ä¶

Creating config file /etc/idmapd.conf with new version

Creating config file /etc/nfs.conf with new version
Adding system user `statd' (UID 115) ...
Adding new user `statd' (UID 115) with group `nogroup' ...
Not creating home directory `/var/lib/nfs'.
Created symlink /etc/systemd/system/multi-user.target.wants/nfs-client.target ‚Üí /lib/systemd/system/nfs-client.target.
Created symlink /etc/systemd/system/remote-fs.target.wants/nfs-client.target ‚Üí /lib/systemd/system/nfs-client.target.
auth-rpcgss-module.service is a disabled or a static unit, not starting it.
nfs-idmapd.service is a disabled or a static unit, not starting it.
nfs-utils.service is a disabled or a static unit, not starting it.
proc-fs-nfsd.mount is a disabled or a static unit, not starting it.
rpc-gssd.service is a disabled or a static unit, not starting it.
rpc-statd-notify.service is a disabled or a static unit, not starting it.
rpc-statd.service is a disabled or a static unit, not starting it.
rpc-svcgssd.service is a disabled or a static unit, not starting it.
rpc_pipefs.target is a disabled or a static unit, not starting it.
var-lib-nfs-rpc_pipefs.mount is a disabled or a static unit, not starting it.
–û–±—Ä–∞–±–∞—Ç—ã–≤–∞—é—Ç—Å—è —Ç—Ä–∏–≥–≥–µ—Ä—ã –¥–ª—è man-db (2.10.2-1) ‚Ä¶
–û–±—Ä–∞–±–∞—Ç—ã–≤–∞—é—Ç—Å—è —Ç—Ä–∏–≥–≥–µ—Ä—ã –¥–ª—è libc-bin (2.35-0ubuntu3.11) ‚Ä¶
Scanning processes...
Scanning linux images...

Running kernel seems to be up-to-date.

No services need to be restarted.

No containers need to be restarted.

No user sessions are running outdated binaries.
```
> –ü—Ä–æ–ø–∏—Å–∞–ª –≤ /etc/fstab
```shell
root@nfs-client:~# cat /etc/fstab
# /etc/fstab: static file system information.
#
# Use 'blkid' to print the universally unique identifier for a
# device; this may be used with UUID= as a more robust way to name devices
# that works even if disks are added and removed. See fstab(5).
#
# <file system> <mount point>   <type>  <options>       <dump>  <pass>
# / was on /dev/ubuntu-vg/ubuntu-lv during curtin installation
/dev/disk/by-id/dm-uuid-LVM-61jM7UCiI4duQYXYcZnoPeMju9cCjGxjKfU8RcID7273Tnf3tmG9OhreJreILp1z / ext4 defaults 0 1
# /boot was on /dev/sda2 during curtin installation
/dev/disk/by-uuid/d7e78c4e-3ff7-4581-ae42-6d36b4d88f2e /boot ext4 defaults 0 1
/swap.img       none    swap    sw      0       0
172.31.134.60:/srv/share/ /mnt nfs vers=3,noauto,x-systemd.automount 0 0
```
> –°–æ–æ–±—â–∏–ª —Å–∏—Å—Ç–µ–º–Ω–æ–º—É –º–µ–Ω–µ–¥–∂–µ—Ä—É systemd, —á—Ç–æ –Ω—É–∂–Ω–æ –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∏—Ç—å —Å–≤–æ—é –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é.
```shell
root@nfs-client:~# systemctl daemon-reload
root@nfs-client:~# systemctl restart remote-fs.target
```
> –ü—Ä–æ–≤–µ—Ä–∏–ª —á—Ç–æ –ø–æ–ª—É—á–∏–ª–æ—Å—å 
```shell
root@nfs-client:~# mount
root@nfs-client:/mnt/upload# mount
... –≤–æ—Ç —Ç—É—Ç 
sunrpc on /run/rpc_pipefs type rpc_pipefs (rw,relatime)
systemd-1 on /mnt type autofs (rw,relatime,fd=44,pgrp=1,timeout=0,minproto=5,maxproto=5,direct,pipe_ino=38914)
172.31.134.60:/srv/share/ on /mnt type nfs (rw,relatime,vers=3,rsize=131072,wsize=131072,namlen=255,hard,proto=tcp,timeo=600,retrans=2,sec=sys,mountaddr=172.31.134.60,mountvers=3,mountport=48476,mountproto=udp,local_lock=none,addr=172.31.134.60)
```
> –ù–∞ –∫–æ–∏–µ–Ω—Ç–µ —Å–æ–∑–¥–∞–ª —Ñ–∞–π–ª 
```shell
root@nfs-client:~# cd /mnt/upload/
root@nfs-client:/mnt/upload# ls -la
total 8
drwxrwxrwx 2 nobody nogroup 4096 –Ω–æ—è 30 20:55 .
drwxr-xr-x 3 nobody nogroup 4096 –Ω–æ—è 30 20:55 ..
root@nfs-client:/mnt/upload# touch test.txt
root@nfs-client:/mnt/upload# ls -la
total 8
drwxrwxrwx 2 nobody nogroup 4096 –Ω–æ—è 30 21:42 .
drwxr-xr-x 3 nobody nogroup 4096 –Ω–æ—è 30 20:55 ..
-rw-r--r-- 1 nobody nogroup    0 –Ω–æ—è 30 21:42 test.txt
```
> –ü–æ—Ç–æ–º —Å–æ–∑–¥–∞–ª —Ñ–∞–π–ª –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ –∏ –ø—Ä–æ–≤–µ—Ä–∏–ª —á—Ç–æ —Ç–∞–º.
```shell
root@nfs-server:/srv/share/upload# exportfs -s
/srv/share  172.31.140.41/20(sync,wdelay,hide,no_subtree_check,sec=sys,rw,secure,root_squash,no_all_squash)
root@nfs-server:~# cd /srv/share/upload/
root@nfs-server:/srv/share/upload# ls -la
total 8
drwxrwxrwx 2 nobody nogroup 4096 Nov 30 21:42 .
drwxr-xr-x 3 nobody nogroup 4096 Nov 30 20:55 ..
-rw-r--r-- 1 nobody nogroup    0 Nov 30 21:42 test.txt
root@nfs-server:/srv/share/upload# touch check_file.txt
root@nfs-server:/srv/share/upload# ls -la
total 8
drwxrwxrwx 2 nobody nogroup 4096 Nov 30 21:47 .
drwxr-xr-x 3 nobody nogroup 4096 Nov 30 20:55 ..
-rw-r--r-- 1 root   root       0 Nov 30 21:47 check_file.txt
-rw-r--r-- 1 nobody nogroup    0 Nov 30 21:42 test.txt

root@nfs-server:~# showmount -e localhost
Export list for localhost:
/srv/share *
```
> –ü—Ä–æ–≤–µ—Ä–∏–ª —á—Ç–æ –Ω–∞ –∫–ª–∏–µ–Ω—Ç–µ
```shell
amyskin@nfs-client:/mnt/upload$ echo "1" > ./client_check_file.txt
amyskin@nfs-client:/mnt/upload$ ls -la
total 12
drwxrwxrwx 2 nobody  nogroup 4096 –Ω–æ—è 30 21:51 .
drwxr-xr-x 3 nobody  nogroup 4096 –Ω–æ—è 30 20:55 ..
-rw-r--r-- 1 root    root       0 –Ω–æ—è 30 21:47 check_file.txt
-rw-rw-r-- 1 amyskin amyskin    2 –Ω–æ—è 30 21:51 client_check_file.txt
-rw-r--r-- 1 nobody  nogroup    0 –Ω–æ—è 30 21:42 test.txt

amyskin@nfs-client:/mnt/upload$ showmount -a 172.31.134.60
All mount points on 172.31.134.60:
172.31.140.41:/srv/share

root@nfs-client:~# df -h
Filesystem                         Size  Used Avail Use% Mounted on
tmpfs                              391M  1,2M  390M   1% /run
/dev/mapper/ubuntu--vg-ubuntu--lv  9,8G  5,1G  4,2G  55% /
tmpfs                              2,0G     0  2,0G   0% /dev/shm
tmpfs                              5,0M     0  5,0M   0% /run/lock
/dev/sda2                          1,7G  130M  1,5G   8% /boot
172.31.134.60:/srv/share/          9,8G  4,5G  4,8G  49% /mnt
tmpfs                              391M  4,0K  391M   1% /run/user/1000
root@nfs-client:~# mount | grep nfs
172.31.134.60:/srv/share/ on /mnt type nfs (rw,relatime,vers=3,rsize=524288,wsize=524288,namlen=255,hard,proto=tcp,timeo=600,retrans=2,sec=sys,mountaddr=172.31.134.60,mountvers=3,mountport=60226,mountproto=udp,local_lock=none,addr=172.31.134.60)
```
